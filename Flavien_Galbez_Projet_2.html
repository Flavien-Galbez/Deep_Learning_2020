<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>





















    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>J&#39;importe les librairie</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">try</span> <span class="p">:</span>
  <span class="c1"># % tensorflow_version only exists in Colab .</span>
  <span class="o">%</span> <span class="n">tensorflow_version</span> <span class="mf">2.</span><span class="n">x</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="p">:</span>
 <span class="k">pass</span>


<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">gpu_device_name</span> <span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>TensorFlow 2.x selected.
2.1.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>J&#39;importe les donnees</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>

<span class="n">leter_recognition_dataset_test</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea">

     
     <output>
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
       
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Saving letter-recognition_test.csv to letter-recognition_test (2).csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>

<span class="n">leter_recognition_dataset_train</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea">

     
     <output>
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
       
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Saving letter_recognition_train_8.csv to letter_recognition_train_8 (2).csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On enregistre les donnees</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;letter-recognition_test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">test_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>     0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
0     U   4  10   6   7   9   9   6   4   3   6   7   7   9   8   5   6
1     N   6   9   8   4   3   8   7   3   4  13   5   8   6   8   0   8
2     V   6   9   8   8  10   7   7   5   4   7   6   8   7   9   7  10
3     I   5   6   6   4   3   7   6   2   7   7   6   9   0   9   4   8
4     N   5   9   7   6   4   9   7   3   5  10   4   6   5   8   1   7
...  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..
3995  D   2   2   3   3   2   7   7   7   6   6   6   4   2   8   3   7
3996  C   7  10   8   8   4   4   8   6   9  12   9  13   2   9   3   7
3997  T   6   9   6   7   5   6  11   3   7  11   9   5   2  12   2   4
3998  S   2   3   4   2   1   8   7   2   6  10   6   8   1   9   5   8
3999  A   4   9   6   6   2   9   5   3   1   8   1   8   2   7   2   8

[4000 rows x 17 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;letter_recognition_train_8.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>      0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
0      X   2   3   3   4   1   7   7   4   4   7   6   8   3   8   4   8
1      C   4   9   5   7   3   4   8   6   7   7   8  15   1   8   4  10
2      T   4   5   5   4   2   5  12   3   7  11  10   4   1  11   1   5
3      G   3   6   4   4   2   6   6   5   5   6   6   9   2   8   4   8
4      Q   7   9   7  11   8   7   9   5   2   7   9  11   4   8   8   9
...   ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..
15995  B   3   4   5   3   3   8   7   3   5  10   5   7   2   8   4   9
15996  J   4  10   5   7   2   8   7   2   7  15   5   8   0   7   1   7
15997  N   1   0   1   0   0   7   7   9   0   6   6   8   3   8   0   8
15998  W   5   7   5   5   5   4   9   2   3   9   8   8   6  11   2   6
15999  K   3   7   3   5   1   3   7   7   3   7   6  11   4   8   2  11

[16000 rows x 17 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On process les donnees</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">normalize</span>
<span class="kn">from</span> <span class="nn">keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="n">trainY</span><span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">trainX</span><span class="o">=</span> <span class="n">train_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trainY</span><span class="p">)</span>
<span class="n">trainX</span><span class="o">=</span><span class="n">trainX</span><span class="o">.</span><span class="n">values</span> <span class="c1">#sett a convertir en matrice</span>
<span class="n">trainY</span><span class="o">=</span><span class="n">trainY</span><span class="o">.</span><span class="n">values</span>

<span class="n">trainX</span><span class="o">.</span><span class="n">shape</span>
<span class="n">trainY</span><span class="o">.</span><span class="n">shape</span>

<span class="n">trainX_norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>

<span class="n">trainY</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">trainY</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trainY</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">testY</span><span class="o">=</span> <span class="n">test_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">testX</span><span class="o">=</span> <span class="n">test_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testY</span><span class="p">)</span>
<span class="n">testX</span><span class="o">=</span><span class="n">testX</span><span class="o">.</span><span class="n">values</span> <span class="c1">#sett a convertir en matrice</span>
<span class="n">testY</span><span class="o">=</span><span class="n">testY</span><span class="o">.</span><span class="n">values</span>

<span class="n">testX</span><span class="o">.</span><span class="n">shape</span>
<span class="n">testY</span><span class="o">.</span><span class="n">shape</span>


<span class="n">testX_norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>

<span class="n">testY</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">testY</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testY</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>       1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
0       2   3   3   4   1   7   7   4   4   7   6   8   3   8   4   8
1       4   9   5   7   3   4   8   6   7   7   8  15   1   8   4  10
2       4   5   5   4   2   5  12   3   7  11  10   4   1  11   1   5
3       3   6   4   4   2   6   6   5   5   6   6   9   2   8   4   8
4       7   9   7  11   8   7   9   5   2   7   9  11   4   8   8   9
...    ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..
15995   3   4   5   3   3   8   7   3   5  10   5   7   2   8   4   9
15996   4  10   5   7   2   8   7   2   7  15   5   8   0   7   1   7
15997   1   0   1   0   0   7   7   9   0   6   6   8   3   8   0   8
15998   5   7   5   5   5   4   9   2   3   9   8   8   6  11   2   6
15999   3   7   3   5   1   3   7   7   3   7   6  11   4   8   2  11

[16000 rows x 16 columns]
0        X
1        C
2        T
3        G
4        Q
        ..
15995    B
15996    J
15997    N
15998    W
15999    K
Name: 0, Length: 16000, dtype: object
(16000, 26)
      1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
0      4  10   6   7   9   9   6   4   3   6   7   7   9   8   5   6
1      6   9   8   4   3   8   7   3   4  13   5   8   6   8   0   8
2      6   9   8   8  10   7   7   5   4   7   6   8   7   9   7  10
3      5   6   6   4   3   7   6   2   7   7   6   9   0   9   4   8
4      5   9   7   6   4   9   7   3   5  10   4   6   5   8   1   7
...   ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ..
3995   2   2   3   3   2   7   7   7   6   6   6   4   2   8   3   7
3996   7  10   8   8   4   4   8   6   9  12   9  13   2   9   3   7
3997   6   9   6   7   5   6  11   3   7  11   9   5   2  12   2   4
3998   2   3   4   2   1   8   7   2   6  10   6   8   1   9   5   8
3999   4   9   6   6   2   9   5   3   1   8   1   8   2   7   2   8

[4000 rows x 16 columns]
0       U
1       N
2       V
3       I
4       N
       ..
3995    D
3996    C
3997    T
3998    S
3999    A
Name: 0, Length: 4000, dtype: object
(4000, 26)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model 1:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="n">model1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,),</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span> 
<span class="n">model1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># compile  model</span>
<span class="n">lrate</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># choose a learning  rate  between 0 and 1 for  your  test</span>
<span class="n">model1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lrate</span><span class="p">),</span> <span class="n">metrics</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#fit model</span>
<span class="n">history1</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">fit</span> <span class="p">(</span><span class="n">trainX_norm</span><span class="p">,</span><span class="n">trainY</span><span class="p">,</span><span class="n">validation_data</span> <span class="o">=</span><span class="p">(</span><span class="n">testX_norm</span> <span class="p">,</span><span class="n">testY</span><span class="p">),</span><span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">model1</span><span class="o">.</span><span class="n">metrics_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 16000 samples, validate on 4000 samples
Epoch 1/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2400 - acc: 0.0648 - val_loss: 3.2421 - val_acc: 0.0617
Epoch 2/20
16000/16000 [==============================] - 2s 114us/sample - loss: 3.2389 - acc: 0.0679 - val_loss: 3.2411 - val_acc: 0.0640
Epoch 3/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2379 - acc: 0.0701 - val_loss: 3.2402 - val_acc: 0.0675
Epoch 4/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2369 - acc: 0.0724 - val_loss: 3.2392 - val_acc: 0.0695
Epoch 5/20
16000/16000 [==============================] - 2s 110us/sample - loss: 3.2359 - acc: 0.0755 - val_loss: 3.2383 - val_acc: 0.0715
Epoch 6/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2349 - acc: 0.0771 - val_loss: 3.2374 - val_acc: 0.0715
Epoch 7/20
16000/16000 [==============================] - 2s 114us/sample - loss: 3.2339 - acc: 0.0772 - val_loss: 3.2365 - val_acc: 0.0725
Epoch 8/20
16000/16000 [==============================] - 2s 117us/sample - loss: 3.2329 - acc: 0.0791 - val_loss: 3.2356 - val_acc: 0.0740
Epoch 9/20
16000/16000 [==============================] - 2s 114us/sample - loss: 3.2319 - acc: 0.0796 - val_loss: 3.2347 - val_acc: 0.0725
Epoch 10/20
16000/16000 [==============================] - 2s 111us/sample - loss: 3.2310 - acc: 0.0798 - val_loss: 3.2338 - val_acc: 0.0730
Epoch 11/20
16000/16000 [==============================] - 2s 115us/sample - loss: 3.2300 - acc: 0.0809 - val_loss: 3.2329 - val_acc: 0.0735
Epoch 12/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2291 - acc: 0.0781 - val_loss: 3.2320 - val_acc: 0.0750
Epoch 13/20
16000/16000 [==============================] - 2s 112us/sample - loss: 3.2281 - acc: 0.0791 - val_loss: 3.2311 - val_acc: 0.0747
Epoch 14/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2271 - acc: 0.0802 - val_loss: 3.2302 - val_acc: 0.0733
Epoch 15/20
16000/16000 [==============================] - 2s 115us/sample - loss: 3.2261 - acc: 0.0803 - val_loss: 3.2293 - val_acc: 0.0735
Epoch 16/20
16000/16000 [==============================] - 2s 112us/sample - loss: 3.2252 - acc: 0.0801 - val_loss: 3.2283 - val_acc: 0.0737
Epoch 17/20
16000/16000 [==============================] - 2s 114us/sample - loss: 3.2242 - acc: 0.0807 - val_loss: 3.2274 - val_acc: 0.0730
Epoch 18/20
16000/16000 [==============================] - 2s 115us/sample - loss: 3.2232 - acc: 0.0819 - val_loss: 3.2265 - val_acc: 0.0737
Epoch 19/20
16000/16000 [==============================] - 2s 113us/sample - loss: 3.2222 - acc: 0.0825 - val_loss: 3.2255 - val_acc: 0.0740
Epoch 20/20
16000/16000 [==============================] - 2s 114us/sample - loss: 3.2212 - acc: 0.0833 - val_loss: 3.2246 - val_acc: 0.0747
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[76]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;loss&#39;, &#39;acc&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history1</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history1</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model 2 :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="n">model2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,),</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,),</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span> 
<span class="n">model2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,),</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span> 
<span class="n">model2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>

<span class="c1"># compile  model</span>
<span class="n">lrate</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># choose a learning  rate  between 0 and 1 for  your  test</span>
<span class="n">model2</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lrate</span><span class="p">),</span> <span class="n">metrics</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>

<span class="c1">#fit model</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span> <span class="p">(</span><span class="n">trainX_norm</span><span class="p">,</span><span class="n">trainY</span><span class="p">,</span><span class="n">validation_data</span> <span class="o">=</span><span class="p">(</span><span class="n">testX_norm</span> <span class="p">,</span><span class="n">testY</span><span class="p">),</span><span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">metrics_names</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_acc&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 16000 samples, validate on 4000 samples
Epoch 1/20
16000/16000 [==============================] - 2s 149us/sample - loss: 3.2567 - acc: 0.0285 - val_loss: 3.2564 - val_acc: 0.0275
Epoch 2/20
16000/16000 [==============================] - 2s 121us/sample - loss: 3.2562 - acc: 0.0299 - val_loss: 3.2558 - val_acc: 0.0288
Epoch 3/20
16000/16000 [==============================] - 2s 122us/sample - loss: 3.2556 - acc: 0.0345 - val_loss: 3.2552 - val_acc: 0.0333
Epoch 4/20
16000/16000 [==============================] - 2s 119us/sample - loss: 3.2549 - acc: 0.0389 - val_loss: 3.2545 - val_acc: 0.0373
Epoch 5/20
16000/16000 [==============================] - 2s 120us/sample - loss: 3.2542 - acc: 0.0439 - val_loss: 3.2538 - val_acc: 0.0430
Epoch 6/20
16000/16000 [==============================] - 2s 122us/sample - loss: 3.2535 - acc: 0.0491 - val_loss: 3.2531 - val_acc: 0.0457
Epoch 7/20
16000/16000 [==============================] - 2s 130us/sample - loss: 3.2528 - acc: 0.0520 - val_loss: 3.2524 - val_acc: 0.0523
Epoch 8/20
16000/16000 [==============================] - 2s 133us/sample - loss: 3.2522 - acc: 0.0544 - val_loss: 3.2518 - val_acc: 0.0505
Epoch 9/20
16000/16000 [==============================] - 2s 132us/sample - loss: 3.2516 - acc: 0.0547 - val_loss: 3.2512 - val_acc: 0.0518
Epoch 10/20
16000/16000 [==============================] - 2s 130us/sample - loss: 3.2510 - acc: 0.0544 - val_loss: 3.2506 - val_acc: 0.0530
Epoch 11/20
16000/16000 [==============================] - 2s 128us/sample - loss: 3.2504 - acc: 0.0543 - val_loss: 3.2501 - val_acc: 0.0545
Epoch 12/20
16000/16000 [==============================] - 2s 120us/sample - loss: 3.2499 - acc: 0.0570 - val_loss: 3.2496 - val_acc: 0.0625
Epoch 13/20
16000/16000 [==============================] - 2s 123us/sample - loss: 3.2494 - acc: 0.0586 - val_loss: 3.2492 - val_acc: 0.0610
Epoch 14/20
16000/16000 [==============================] - 2s 123us/sample - loss: 3.2490 - acc: 0.0590 - val_loss: 3.2488 - val_acc: 0.0608
Epoch 15/20
16000/16000 [==============================] - 2s 123us/sample - loss: 3.2486 - acc: 0.0604 - val_loss: 3.2484 - val_acc: 0.0602
Epoch 16/20
16000/16000 [==============================] - 2s 121us/sample - loss: 3.2482 - acc: 0.0611 - val_loss: 3.2480 - val_acc: 0.0617
Epoch 17/20
16000/16000 [==============================] - 2s 122us/sample - loss: 3.2478 - acc: 0.0631 - val_loss: 3.2476 - val_acc: 0.0637
Epoch 18/20
16000/16000 [==============================] - 2s 121us/sample - loss: 3.2473 - acc: 0.0632 - val_loss: 3.2471 - val_acc: 0.0653
Epoch 19/20
16000/16000 [==============================] - 2s 121us/sample - loss: 3.2469 - acc: 0.0631 - val_loss: 3.2467 - val_acc: 0.0625
Epoch 20/20
16000/16000 [==============================] - 2s 121us/sample - loss: 3.2465 - acc: 0.0634 - val_loss: 3.2463 - val_acc: 0.0648
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Le model 2 est plus proche que le model 1. Je n&#39;ai pas eu le temps de tester d&#39;autres models, j&#39;ai &#233;t&#233; pris par le temps.</p>

</div>
</div>
</div>
    </div>
  </div>


 



<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.21.5.29742 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130',false); });</script></body></html>